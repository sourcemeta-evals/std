{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "ISO 8601-1:2019 Calendar Duration (Basic Format)",
  "description": "A duration in calendar units (years, months, days) using basic format without separators, with validation to prevent invalid month/day combinations",
  "$comment": "https://www.iso.org/standard/70907.html",
  "examples": [ "P1Y", "P2M", "P3D", "P1Y2M3D", "P0Y0M0D" ],
  "x-license": "https://github.com/sourcemeta/std/blob/main/LICENSE",
  "type": "string",
  "not": {
    "anyOf": [
      {
        "$comment": "Disallow February with more than 29 days",
        "pattern": "P(?:[0-9]+Y)?02M(?:3[0-9]|[4-9][0-9]|[0-9]{3,})D"
      },
      {
        "$comment": "Disallow April (04) with more than 30 days",
        "pattern": "P(?:[0-9]+Y)?04M(?:3[1-9]|[4-9][0-9]|[0-9]{3,})D"
      },
      {
        "$comment": "Disallow June (06) with more than 30 days",
        "pattern": "P(?:[0-9]+Y)?06M(?:3[1-9]|[4-9][0-9]|[0-9]{3,})D"
      },
      {
        "$comment": "Disallow September (09) with more than 30 days",
        "pattern": "P(?:[0-9]+Y)?09M(?:3[1-9]|[4-9][0-9]|[0-9]{3,})D"
      },
      {
        "$comment": "Disallow November (11) with more than 30 days",
        "pattern": "P(?:[0-9]+Y)?11M(?:3[1-9]|[4-9][0-9]|[0-9]{3,})D"
      },
      {
        "$comment": "Disallow any month with more than 31 days (only when month is specified)",
        "pattern": "P(?:[0-9]+Y)?[0-9]+M(?:3[2-9]|[4-9][0-9]|[0-9]{3,})D"
      },
      {
        "$comment": "Disallow more than 31 days when only day component is present (no year, no month)",
        "pattern": "^P(?:3[2-9]|[4-9][0-9]|[0-9]{3,})D$"
      },
      {
        "$comment": "Disallow months greater than 12",
        "pattern": "P(?:[0-9]+Y)?(?:1[3-9]|[2-9][0-9]|[0-9]{3,})M"
      },
      {
        "$comment": "Disallow empty duration (must have at least one component)",
        "pattern": "^P$"
      }
    ]
  },
  "pattern": "^P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?$",
  "minLength": 2
}
